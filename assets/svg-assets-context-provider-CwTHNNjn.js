import{j as u}from"./jsx-runtime-Cf8x2fCZ.js";import{a as C,c as v,d as N,S as T}from"./generic-station-number-CRGhucoZ.js";import{F as $,a as D}from"./station-number-Bp0ge98Q.js";import{S as E,a as W}from"./station-number-BwIm3lfX.js";import{r as d}from"./index-BlmOqGMO.js";function j({position:r,...t}){const a=r==="right"?"rotate(180)":"rotate(0)";return u.jsx("circle",{cx:-38.3*.4,cy:0,r:v/4,stroke:"#aaa",strokeWidth:C*1.75,fill:"white",strokeDasharray:"2.7 2.5",transform:a,...t})}j.__docgenInfo={description:"",methods:[],displayName:"OSILink",props:{position:{required:!0,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:""}}};const w=(r,t)=>Array.from(Array(r).keys()).map(a=>(a-(r-1)/2)*t),B=(r,t,a)=>{if(r<=0)return[];if(r===1)return[[0,0]];const i=t>r?r:t,g=v,m=N,h=w(i,g),x=Math.ceil(r/i),y=w(x,m),I=r%i,e=[];for(let c=0;c<x;c++){const S=a?x-1:0;if(I===0||c!==S)for(let s=0;s<i;s++)e.push([h[s],y[c]]);else{const s=w(I,g);for(let l=0;l<I;l++)e.push([s[l],y[c]])}}return e},R=r=>r==="fmetro"?D:W,p=C*7,_=C*2.2,X=d.forwardRef(function({stations:t,textClassName:a,columns:i=2,topHeavy:g,anchorAt:m,osiPosition:h,children:x,...y},I){const e=d.useMemo(()=>B(t.length,i,g),[t.length,i,g]),[c,S]=d.useMemo(()=>{if(m===void 0)return[0,0];if(m<0||m>=e.length)return console.warn(`<InterchangeStation2024/>, anchor index ${m} is out of bound`),[0,0];{const[n,o]=e[m];return[-n,-o]}},[e,m]),s=d.useRef(null),l=d.useRef([]);d.useEffect(()=>{l.current=l.current.slice(0,t.length)},[t.length]);const k=t.length===2&&i===1&&!!h;return d.useImperativeHandle(I,()=>({target:s.current,children:l.current,getCoordinates:()=>e,getCorrectedBBox:()=>{var o;const n=((o=s.current)==null?void 0:o.getBBox())??{x:0,y:0,width:0,height:0};return n.y-=p/2,n.height+=p,k?(h==="left"?n.x-=_/2:n.x-=p/2,n.width+=_/2+p/2):(n.x-=p/2,n.width+=p),n},getTranslate:()=>[c,S]}),[e,c,S,s.current,l.current,h]),u.jsxs("g",{ref:s,transform:`translate(${c},${S})`,...y,children:[t.map(({style:n},o)=>{const f=R(n);return u.jsx(f,{stroke:"#aaa",filled:!0,strokeWidth:p,transform:`translate(${e[o][0]},${e[o][1]})`},o)}),k&&u.jsx(j,{position:h,r:v/2.9,strokeWidth:_,strokeDasharray:void 0}),t.map(({style:n},o)=>{const f=R(n);return u.jsx(f,{stroke:"white",filled:!0,strokeWidth:C*2.6,transform:`translate(${e[o][0]},${e[o][1]})`},o)}),k&&u.jsx(j,{position:h}),t.length&&u.jsx("rect",{fill:"white",x:-12,y:e[0][1],width:24,height:-e[0][1]*2}),t.map(({style:n,...o},f)=>{const O=n==="fmetro"?$:E;return u.jsx(O,{ref:M=>l.current[f]=M,transform:`translate(${e[f][0]},${e[f][1]})`,textClassName:a,...o},f)}),x]})});function L({children:r}){const[t,a]=d.useState(Math.random());return u.jsx(T.Provider,{value:{updateId:t,update:()=>a(Math.random())},children:r})}L.__docgenInfo={description:"",methods:[],displayName:"SvgAssetsContextProvider"};export{X as I,L as S};
