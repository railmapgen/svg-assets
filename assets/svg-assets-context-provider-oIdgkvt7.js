import{j as u}from"./jsx-runtime-BjgbQsUx.js";import{b as y,I as C,c as O,S as T}from"./generic-station-number-CJH3dPn-.js";import{S as $,F as B}from"./station-number-CPUTGu0S.js";import{S as D,a as E}from"./station-number-BA2obAl2.js";import{r as f}from"./index-DEBVq0NN.js";function j({position:r,...e}){const a=r==="right"?"rotate(180)":"rotate(0)";return u.jsx("circle",{cx:-y*.4,cy:0,r:y/4,stroke:"#aaa",strokeWidth:C*1.75,fill:"white",strokeDasharray:"2.7 2.5",transform:a,...e})}j.__docgenInfo={description:"",methods:[],displayName:"OSILink",props:{position:{required:!0,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:""}}};const w=(r,e)=>Array.from(Array(r).keys()).map(a=>(a-(r-1)/2)*e),M=(r,e,a)=>{if(r<=0)return[];if(r===1)return[[0,0]];const i=e>r?r:e,g=y,d=O,p=w(i,g),x=Math.ceil(r/i),k=w(x,d),I=r%i,t=[];for(let l=0;l<x;l++){const S=a?x-1:0;if(I===0||l!==S)for(let s=0;s<i;s++)t.push([p[s],k[l]]);else{const s=w(I,g);for(let c=0;c<I;c++)t.push([s[c],k[l]])}}return t},R=r=>r==="fmetro"?B:E,h=C*7,v=C*2.2,W=f.forwardRef(function({stations:e,textClassName:a,columns:i=2,topHeavy:g,anchorAt:d,osiPosition:p,children:x,...k},I){const t=f.useMemo(()=>M(e.length,i,g),[e.length,i,g]),[l,S]=f.useMemo(()=>{if(d===void 0)return[0,0];if(d<0||d>=t.length)return console.warn(`<InterchangeStation2024/>, anchor index ${d} is out of bound`),[0,0];{const[n,o]=t[d];return[-n,-o]}},[t,d]),s=f.useRef(null),c=f.useRef([]);f.useEffect(()=>{c.current=c.current.slice(0,e.length)},[e.length]);const _=e.length===2&&i===1&&!!p;return f.useImperativeHandle(I,()=>({target:s.current,children:c.current,getCoordinates:()=>t,getCorrectedBBox:()=>{var o;const n=((o=s.current)==null?void 0:o.getBBox())??{x:0,y:0,width:0,height:0};return n.y-=h/2,n.height+=h,_?(p==="left"?n.x-=v/2:n.x-=h/2,n.width+=v/2+h/2):(n.x-=h/2,n.width+=h),n},getTranslate:()=>[l,S]}),[t,l,S,s.current,c.current,p]),u.jsxs("g",{ref:s,transform:`translate(${l},${S})`,...k,children:[e.map(({style:n},o)=>{const m=R(n);return u.jsx(m,{stroke:"#aaa",filled:!0,strokeWidth:h,transform:`translate(${t[o][0]},${t[o][1]})`},o)}),_&&u.jsx(j,{position:p,r:y/2.9,strokeWidth:v,strokeDasharray:void 0}),e.map(({style:n},o)=>{const m=R(n);return u.jsx(m,{stroke:"white",filled:!0,strokeWidth:C*2.6,transform:`translate(${t[o][0]},${t[o][1]})`},o)}),_&&u.jsx(j,{position:p}),e.length&&u.jsx("rect",{fill:"white",x:-12,y:t[0][1],width:24,height:-t[0][1]*2}),e.map(({style:n,...o},m)=>{const b=n==="fmetro"?$:D;return u.jsx(b,{ref:N=>c.current[m]=N,transform:`translate(${t[m][0]},${t[m][1]})`,textClassName:a,...o},m)}),x]})});W.__docgenInfo={description:"",methods:[{name:"getCoordinates",docblock:null,modifiers:[],params:[],returns:null},{name:"getCorrectedBBox",docblock:null,modifiers:[],params:[],returns:null},{name:"getTranslate",docblock:null,modifiers:[],params:[],returns:null}],displayName:"InterchangeStation2024",props:{columns:{defaultValue:{value:"2",computed:!1},required:!1}}};function L({children:r}){const[e,a]=f.useState(Math.random());return u.jsx(T.Provider,{value:{updateId:e,update:()=>a(Math.random())},children:r})}L.__docgenInfo={description:"",methods:[],displayName:"SvgAssetsContextProvider"};export{W as I,L as S};
