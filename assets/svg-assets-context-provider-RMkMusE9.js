import{j as l,r as m}from"./iframe-CP1cIlOF.js";import{I as w,a as k,b as T,S as $}from"./generic-station-number-CvzymBh3.js";import{F as D,a as E}from"./station-number-DXqGNN0c.js";import{S as W,a as b}from"./station-number-HhB-07uH.js";function R({position:r,...e}){const s=r==="right"?"rotate(180)":"rotate(0)";return l.jsx("circle",{cx:-k*.4,cy:0,r:k/4,stroke:"#aaa",strokeWidth:w*1.75,fill:"white",strokeDasharray:"2.7 2.5",transform:s,...e})}R.__docgenInfo={description:"",methods:[],displayName:"OSILink",props:{position:{required:!0,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:""}}};const j=(r,e)=>Array.from(Array(r).keys()).map(s=>(s-(r-1)/2)*e),B=(r,e,s)=>{if(r<=0)return[];if(r===1)return[[0,0]];const h=e>r?r:e,p=k,y=T,u=j(h,p),a=Math.ceil(r/h),C=j(a,y),g=r%h,x=[];for(let t=0;t<a;t++){const I=s?a-1:0;if(g===0||t!==I)for(let c=0;c<h;c++)x.push([u[c],C[t]]);else{const c=j(g,p);for(let i=0;i<g;i++)x.push([c[i],C[t]])}}return x},O=r=>r==="fmetro"?E:b,d=w*7,v=w*2.2,X=m.forwardRef(function({stations:e,classNames:s,textProps:h,columns:p=2,topHeavy:y,anchorAt:u,osiPosition:a,children:C,...g},x){const t=m.useMemo(()=>B(e.length,p,y),[e.length,p,y]),[I,c]=m.useMemo(()=>{if(u===void 0)return[0,0];if(u<0||u>=t.length)return console.warn(`<InterchangeStation2024/>, anchor index ${u} is out of bound`),[0,0];{const[n,o]=t[u];return[-n,-o]}},[t,u]),i=m.useRef(null),S=m.useRef([]);m.useEffect(()=>{S.current=S.current.slice(0,e.length)},[e.length]);const _=e.length===2&&p===1&&!!a;return m.useImperativeHandle(x,()=>({target:i.current,children:S.current,getCoordinates:()=>t,getCorrectedBBox:()=>{const n=i.current?.getBBox()??{x:0,y:0,width:0,height:0};return n.y-=d/2,n.height+=d,_?(a==="left"?n.x-=v/2:n.x-=d/2,n.width+=v/2+d/2):(n.x-=d/2,n.width+=d),n},getTranslate:()=>[I,c]}),[t,I,c,i.current,S.current,a]),l.jsxs("g",{ref:i,transform:`translate(${I},${c})`,...g,children:[e.map(({style:n},o)=>{const f=O(n);return l.jsx(f,{stroke:"#aaa",filled:!0,strokeWidth:d,transform:`translate(${t[o][0]},${t[o][1]})`},o)}),_&&l.jsx(R,{position:a,r:k/2.9,strokeWidth:v,strokeDasharray:void 0}),e.map(({style:n},o)=>{const f=O(n);return l.jsx(f,{stroke:"white",filled:!0,strokeWidth:w*2.6,transform:`translate(${t[o][0]},${t[o][1]})`},o)}),_&&l.jsx(R,{position:a}),e.length&&l.jsx("rect",{fill:"white",x:-12,y:t[0][1],width:24,height:-t[0][1]*2}),e.map(({style:n,...o},f)=>{const M=n==="fmetro"?D:W;return l.jsx(M,{ref:N=>S.current[f]=N,transform:`translate(${t[f][0]},${t[f][1]})`,classNames:s,textProps:h,...o},f)}),C]})});function L({children:r}){const[e,s]=m.useState(Math.random());return l.jsx($.Provider,{value:{updateId:e,update:()=>s(Math.random())},children:r})}L.__docgenInfo={description:"",methods:[],displayName:"SvgAssetsContextProvider"};export{X as I,L as S};
