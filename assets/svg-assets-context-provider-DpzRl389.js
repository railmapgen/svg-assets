import{j as l}from"./jsx-runtime-Cf8x2fCZ.js";import{a as k,c as R,d as T,S as $}from"./generic-station-number-gkagBugv.js";import{F as D,a as E}from"./station-number-B49vEcTX.js";import{S as W,a as B}from"./station-number-h6JSOFmI.js";import{r as f}from"./index-BlmOqGMO.js";function v({position:r,...e}){const s=r==="right"?"rotate(180)":"rotate(0)";return l.jsx("circle",{cx:-38.3*.4,cy:0,r:R/4,stroke:"#aaa",strokeWidth:k*1.75,fill:"white",strokeDasharray:"2.7 2.5",transform:s,...e})}v.__docgenInfo={description:"",methods:[],displayName:"OSILink",props:{position:{required:!0,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:""}}};const _=(r,e)=>Array.from(Array(r).keys()).map(s=>(s-(r-1)/2)*e),L=(r,e,s)=>{if(r<=0)return[];if(r===1)return[[0,0]];const h=e>r?r:e,p=R,y=T,u=_(h,p),a=Math.ceil(r/h),C=_(a,y),g=r%h,x=[];for(let t=0;t<a;t++){const I=s?a-1:0;if(g===0||t!==I)for(let c=0;c<h;c++)x.push([u[c],C[t]]);else{const c=_(g,p);for(let i=0;i<g;i++)x.push([c[i],C[t]])}}return x},O=r=>r==="fmetro"?E:B,d=k*7,j=k*2.2,A=f.forwardRef(function({stations:e,classNames:s,textProps:h,columns:p=2,topHeavy:y,anchorAt:u,osiPosition:a,children:C,...g},x){const t=f.useMemo(()=>L(e.length,p,y),[e.length,p,y]),[I,c]=f.useMemo(()=>{if(u===void 0)return[0,0];if(u<0||u>=t.length)return console.warn(`<InterchangeStation2024/>, anchor index ${u} is out of bound`),[0,0];{const[n,o]=t[u];return[-n,-o]}},[t,u]),i=f.useRef(null),S=f.useRef([]);f.useEffect(()=>{S.current=S.current.slice(0,e.length)},[e.length]);const w=e.length===2&&p===1&&!!a;return f.useImperativeHandle(x,()=>({target:i.current,children:S.current,getCoordinates:()=>t,getCorrectedBBox:()=>{var o;const n=((o=i.current)==null?void 0:o.getBBox())??{x:0,y:0,width:0,height:0};return n.y-=d/2,n.height+=d,w?(a==="left"?n.x-=j/2:n.x-=d/2,n.width+=j/2+d/2):(n.x-=d/2,n.width+=d),n},getTranslate:()=>[I,c]}),[t,I,c,i.current,S.current,a]),l.jsxs("g",{ref:i,transform:`translate(${I},${c})`,...g,children:[e.map(({style:n},o)=>{const m=O(n);return l.jsx(m,{stroke:"#aaa",filled:!0,strokeWidth:d,transform:`translate(${t[o][0]},${t[o][1]})`},o)}),w&&l.jsx(v,{position:a,r:R/2.9,strokeWidth:j,strokeDasharray:void 0}),e.map(({style:n},o)=>{const m=O(n);return l.jsx(m,{stroke:"white",filled:!0,strokeWidth:k*2.6,transform:`translate(${t[o][0]},${t[o][1]})`},o)}),w&&l.jsx(v,{position:a}),e.length&&l.jsx("rect",{fill:"white",x:-12,y:t[0][1],width:24,height:-t[0][1]*2}),e.map(({style:n,...o},m)=>{const M=n==="fmetro"?D:W;return l.jsx(M,{ref:N=>S.current[m]=N,transform:`translate(${t[m][0]},${t[m][1]})`,classNames:s,textProps:h,...o},m)}),C]})});function b({children:r}){const[e,s]=f.useState(Math.random());return l.jsx($.Provider,{value:{updateId:e,update:()=>s(Math.random())},children:r})}b.__docgenInfo={description:"",methods:[],displayName:"SvgAssetsContextProvider"};export{A as I,b as S};
